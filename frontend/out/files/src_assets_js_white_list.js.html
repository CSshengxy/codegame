<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/assets/js/white_list.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/actions.html">actions</a></li>
                                <li><a href="../classes/BlockBase.html">BlockBase</a></li>
                                <li><a href="../classes/blockConstData.html">blockConstData</a></li>
                                <li><a href="../classes/EditMap.html">EditMap</a></li>
                                <li><a href="../classes/EditorBase.html">EditorBase</a></li>
                                <li><a href="../classes/editorConstData.html">editorConstData</a></li>
                                <li><a href="../classes/MainPage.html">MainPage</a></li>
                                <li><a href="../classes/MapEditor.html">MapEditor</a></li>
                                <li><a href="../classes/MapSqure.html">MapSqure</a></li>
                                <li><a href="../classes/MenuBarLogged.html">MenuBarLogged</a></li>
                                <li><a href="../classes/MenuBarUnlogged.html">MenuBarUnlogged</a></li>
                                <li><a href="../classes/mutations.html">mutations</a></li>
                                <li><a href="../classes/PageNotFound.html">PageNotFound</a></li>
                                <li><a href="../classes/resetPasswordForm.html">resetPasswordForm</a></li>
                                <li><a href="../classes/SelectLevel.html">SelectLevel</a></li>
                                <li><a href="../classes/SigninForm.html">SigninForm</a></li>
                                <li><a href="../classes/SignupForm.html">SignupForm</a></li>
                                <li><a href="../classes/state.html">state</a></li>
                                <li><a href="../classes/store.html">store</a></li>
                                <li><a href="../classes/UserInfo.html">UserInfo</a></li>
                                <li><a href="../classes/util.html">util</a></li>
                                <li><a href="../classes/whiteListConstData.html">whiteListConstData</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/assets/js/white_list.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
let commandCodeLibrary = [
    // abcdefg
    [/^\s*\w*\.?collect\(&quot;\w*&quot;\)\s*$/, /^\s*\w*\.?drop\(&quot;\w*&quot;\)\s*$/, /^\s*\w*\.?go\(\w*\)\s*$/, /^\s*\w*\.?fly\(\)\s*$/, /^\s*function-end\s*$/, /^\s*function \w+$/],
    // hijklmn
    [],
    // opqrstu
    [/^\s*repeat \w+ times\s*$/, /^\s*repeat-end\s*$/, /^\s*\w*\.?say\(&quot;\w*&quot;\)\s*$/, /^\s*\w*\.?turn\(&quot;left&quot;\)\s*$/, /^\s*\w*\.?turn\(&quot;right&quot;\)\s*$/],
    // vwxyz
    [/^\s*var\s+[A-Za-z]\w*\s*=\s*(\d+|[A-Za-z]\w*)\s*$/, /^\s*var\s+[A-Za-z]\w*\s*/, /^\s*\w*\.?wait\(\w*\)\s*$/],
    // 定义的变量  放进来一个带等于号的 一个不带等于号的 和一个对应的正则表达式字符串
    [],
    // 定义的函数  放进带（）的正则表达式和相应的字符串（不处理含参的函数）
    []
    // 面向对象的放进正常的里面  手动处理 不受用户支配
]
/**
* 代码白名单
*
* @class whiteListConstData
*/
let whiteListConstData = {
    /**
    *安全代码库
    *
    * @property commandCodeLibrary
    * @type {List}
    */
    commandCodeLibrary,
    /**
    *白名单初始化函数
    *
    * @method init
    */
    init: function () {
        this.commandCodeLibrary = [
            [/^\s*\w*\.?collect\(&quot;\w*&quot;\)\s*$/, /^\s*\w*\.?drop\(&quot;\w*&quot;\)\s*$/, /^\s*\w*\.?go\(\w*\)\s*$/, /^\s*\w*\.?fly\(\)\s*$/, /^\s*function-end\s*$/, /^\s*function \w+$/],
            [],
            [/^\s*repeat \w+ times\s*$/, /^\s*repeat-end\s*$/, /^\s*\w*\.?say\(&quot;\w*&quot;\)\s*$/, /^\s*\w*\.?turn\(&quot;left&quot;\)\s*$/, /^\s*\w*\.?turn\(&quot;right&quot;\)\s*$/],
            [/^\s*var\s+[A-Za-z]\w*\s*=\s*(\d+|[A-Za-z]\w*)\s*$/, /^\s*var\s+[A-Za-z]\w*\s*/, /^\s*\w*\.?wait\(\w*\)\s*$/],
            [],
            []
        ]
    },
    /**
    *白名单清空变量和函数列表的函数
    *
    * @method clean
    */
    clean: function () {
        this.commandCodeLibrary[4] = &#x27;&#x27;
        this.commandCodeLibrary[5] = &#x27;&#x27;
    },
    /**
    *根据输入的角色姓名获取角色的对应序号
    *
    * @method indexOfCharacter
    * @return {Number} 如果角色姓名为 Nancy 返回 0; Carla 1; 不存在 2；
    */
    indexOfCharacter: function (name) {
        if (name === &#x27;Nancy&#x27;) {
            return 0
        } else if (name === &#x27;Carla&#x27;) {
            return 1
        } else {
            return 2
        }
    },
    /**
    *将用户输入的Name.xxx()转换为名字序号作为参数的字符串
    *
    * @method formateTheName
    * @param {String} code 要转换的代码
    * @return {String} 名字序号作为参数的字符串
    */
    formateTheName: function (code) {
        let typeOfCharacter = 0
        let indexOfDot = code.indexOf(&#x27;.&#x27;)
        if (indexOfDot !== -1) {
            let codeList = code.split(&#x27;.&#x27;)
            codeList[0] = codeList[0].replace(/\s*/g, &#x27;&#x27;)
            let typeOfCharacter = this.indexOfCharacter(codeList[0])
            if (typeOfCharacter === 2) {
                return false
            }
            code = codeList[1].replace(&#x27;(&#x27;, &#x27;(&#x27; + typeOfCharacter + &#x27;, &#x27;)
        } else {
            code = code.replace(&#x27;(&#x27;, &#x27;(&#x27; + typeOfCharacter + &#x27;, &#x27;)
        }
        return code
    },
    /**
    *转换对应代码库位置[0, 0]的代码
    *
    * @method formatFunction00
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction00: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;collect&#x27;, &#x27;this.collect&#x27;) + &#x27;;&#x27;
        }
        return code
    },
    /**
    *转换对应代码库位置[0, 1]的代码
    *
    * @method formatFunction01
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction01: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;drop&#x27;, &#x27;this.drop&#x27;) + &#x27;;&#x27;
        }
        return code
    },
    /**
    *转换对应代码库位置[0, 2]的代码
    *
    * @method formatFunction02
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction02: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;go&#x27;, &#x27;this.go&#x27;) + &#x27;;&#x27;
        }
        return code
    },
    /**
    *转换对应代码库位置[0, 3]的代码
    *
    * @method formatFunction03
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction03: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;fly&#x27;, &#x27;this.fly&#x27;) + &#x27;;&#x27;
            code = code.replace(&#x27;, &#x27;, &#x27;&#x27;)
        }
        return code
    },
    /**
    *转换对应代码库位置[0, 4]的代码
    *
    * @method formatFunction04
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction04: function (code) {
        code = code.replace(&#x27;function-end&#x27;, &#x27;\&#x27;&#x27;)
        return code + &#x27;;&#x27;
    },
    /**
    *转换对应代码库位置[0, 5]的代码
    *
    * @method formatFunction05
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction05: function (code) {
        let functionName = code.replace(&#x27;function&#x27;, &#x27;&#x27;) + &#x27;\\(\\)&#x27;
        functionName = functionName.replace(/\s*/g, &#x27;&#x27;)
        let regExpString = &#x27;^\\s*&#x27; + functionName + &#x27;\\s*$&#x27;
        // 处理重复定义函数的情况
        if (this.commandCodeLibrary[5].indexOf(regExpString) !== -1) {
            return false
        }
        this.commandCodeLibrary[5].push(new RegExp(regExpString))
        this.commandCodeLibrary[5].push(regExpString)
        code = code.replace(&#x27;function &#x27;, &#x27;this.functionSet[\&#x27;&#x27;) + &#x27;\&#x27;]=\&#x27;&#x27;
        return code
    },
    /**
    *转换对应代码库位置[2, 0]的代码
    *
    * @method formatFunction20
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction20: function (code) {
        code = code.replace(&#x27;repeat &#x27;, &#x27;for(let i = 0; i &lt; &#x27;)
        code = code.replace(&#x27; times&#x27;, &#x27;; i++) {&#x27;)
        return code
    },
    /**
    *转换对应代码库位置[2, 1]的代码
    *
    * @method formatFunction21
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction21: function (code) {
        code = code.replace(&#x27;repeat-end&#x27;, &#x27;}&#x27;)
        return code
    },
    /**
    *转换对应代码库位置[2, 2]的代码
    *
    * @method formatFunction22
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction22: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;say&#x27;, &#x27;this.say&#x27;) + &#x27;;&#x27;
        }
        return code
    },
    /**
    *转换对应代码库位置[2, 3]的代码
    *
    * @method formatFunction23
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction23: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;turn&#x27;, &#x27;this.turn&#x27;) + &#x27;;&#x27;
        }
        return code
    },
    /**
    *转换对应代码库位置[2, 4]的代码
    *
    * @method formatFunction24
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction24: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;turn&#x27;, &#x27;this.turn&#x27;) + &#x27;;&#x27;
        }
        return code
    },
    /**
    *转换对应代码库位置[3, 0]的代码
    *
    * @method formatFunction30
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction30: function (code) {
        &#x27;var x = 3&#x27;
        let temp = code.replace(&#x27;var&#x27;, &#x27;&#x27;)
        temp = temp.replace(/=\s*(\d+|[A-Za-z]\w*)\s*/, &#x27;&#x27;)
        let variable = temp.replace(/\s*/g, &#x27;&#x27;)
        let regExpString = &#x27;^\\s*&#x27; + variable + &#x27;\\s*$&#x27;
        // 处理重复定义变量的情况
        if (this.commandCodeLibrary[4].indexOf(regExpString) === -1) {
            this.commandCodeLibrary[4].push(regExpString)
            let regExp = new RegExp(regExpString)
            this.commandCodeLibrary[4].push(regExp)
            regExpString = &#x27;^\\s*&#x27; + variable + &#x27;\\s*=\\s*(\\d+|[A-Za-z]\\w*)\\s*$&#x27;
            regExp = new RegExp(regExpString)
            this.commandCodeLibrary[4].push(regExp)
        }
        return code + &#x27;;&#x27;
    },
    /**
    *转换对应代码库位置[3, 1]的代码
    *
    * @method formatFunction31
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction31: function (code) {
        let temp = code.replace(&#x27;var&#x27;, &#x27;&#x27;)
        let variable = temp.replace(/\s*/g, &#x27;&#x27;)
        let regExpString = &#x27;^\\s*&#x27; + variable + &#x27;\\s*$&#x27;
        // 处理重复定义变量的情况
        if (this.commandCodeLibrary[4].indexOf(regExpString) === -1) {
            this.commandCodeLibrary[4].push(regExpString)
            let regExp = new RegExp(regExpString)
            this.commandCodeLibrary[4].push(regExp)
            regExpString = &#x27;^\\s*&#x27; + variable + &#x27;\\s*=\\s*(\\d+|[A-Za-z]\\w*)\\s*$&#x27;
            regExp = new RegExp(regExpString)
            this.commandCodeLibrary[4].push(regExp)
        }
        return code + &#x27;;&#x27;
    },
    /**
    *转换对应代码库位置[3, 2]的代码
    *
    * @method formatFunction32
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction32: function (code) {
        code = this.formateTheName(code)
        if (code !== false) {
            code = code.replace(&#x27;wait&#x27;, &#x27;this.wait&#x27;) + &#x27;;&#x27;
        }
        return code
    },
    /**
    *转换对应代码库位置[4, x]的代码
    *
    * @method formatFunction4
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction4: function (code) {
        return code + &#x27;;&#x27;
    },
    /**
    *转换对应代码库位置[5, x]的代码
    *
    * @method formatFunction5
    * @param {String} code 要转换的代码
    * @return {String} 安全可执行代码
    */
    formatFunction5: function (code) {
        let functionName = code.replace(&#x27;()&#x27;, &#x27;&#x27;)
        functionName = functionName.replace(/\s*/g, &#x27;&#x27;)
        code = &#x27;eval(this.functionSet[&quot;&#x27; + functionName + &#x27;&quot;]);&#x27;
        return code
    }
}

module.exports = whiteListConstData

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
