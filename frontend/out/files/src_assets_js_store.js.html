<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/assets/js/store.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/actions.html">actions</a></li>
                                <li><a href="../classes/BlockBase.html">BlockBase</a></li>
                                <li><a href="../classes/blockConstData.html">blockConstData</a></li>
                                <li><a href="../classes/EditMap.html">EditMap</a></li>
                                <li><a href="../classes/EditorBase.html">EditorBase</a></li>
                                <li><a href="../classes/editorConstData.html">editorConstData</a></li>
                                <li><a href="../classes/MainPage.html">MainPage</a></li>
                                <li><a href="../classes/MapEditor.html">MapEditor</a></li>
                                <li><a href="../classes/MapSqure.html">MapSqure</a></li>
                                <li><a href="../classes/MenuBarLogged.html">MenuBarLogged</a></li>
                                <li><a href="../classes/MenuBarUnlogged.html">MenuBarUnlogged</a></li>
                                <li><a href="../classes/mutations.html">mutations</a></li>
                                <li><a href="../classes/PageNotFound.html">PageNotFound</a></li>
                                <li><a href="../classes/resetPasswordForm.html">resetPasswordForm</a></li>
                                <li><a href="../classes/SelectLevel.html">SelectLevel</a></li>
                                <li><a href="../classes/SigninForm.html">SigninForm</a></li>
                                <li><a href="../classes/SignupForm.html">SignupForm</a></li>
                                <li><a href="../classes/state.html">state</a></li>
                                <li><a href="../classes/store.html">store</a></li>
                                <li><a href="../classes/UserInfo.html">UserInfo</a></li>
                                <li><a href="../classes/util.html">util</a></li>
                                <li><a href="../classes/whiteListConstData.html">whiteListConstData</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/assets/js/store.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
import Vue from &#x27;vue&#x27;
import Vuex from &#x27;vuex&#x27;

Vue.use(Vuex)

/**
*封装vuex全局常量变量的类
*
* @property state
* @type {Class}
* @for store
*/
const state = {
    /**
    *界面需要的字符串常量表
    *
    * @property _const
    * @type {Object}
    * @for state
    */
    _const: {
        BLANK: &#x27; &#x27;,
        BLOCK: &#x27;Block&#x27;,
        BUY_NOW: &#x27;立即购买&#x27;,
        CANCEL: &#x27;取消&#x27;,
        CAPTCHA: &#x27;验证码&#x27;,
        CHECK_FORM: &#x27;信息错误,请检查&#x27;,
        CLEAN: &#x27;Clean&#x27;,
        CLICK_TO_CANCEL_FAVORITE: &#x27;点击取消收藏&#x27;,
        CLICK_TO_CANCEL_PUBLISH: &#x27;点击取消发布&#x27;,
        CLICK_TO_FAVORITE: &#x27;点击收藏地图&#x27;,
        CLICK_TO_PUBLISH: &#x27;点击发布&#x27;,
        CONFIRM: &#x27;确认&#x27;,
        CONTINUE_GAME: &#x27;继续游戏&#x27;,
        DEFAULT_MAP: {
            id: 1,
            map: &#x27;0000000000000000000000103000000010000000001000000000100000000010000000001040000000000000000000000000&#x27;,
            name: &#x27;XXX要回家&#x27;,
            tips: &#x27;XXX误入了迷失森林，请根据它来时留下的小旗帮助它回家吧！\n请使用go(5)使XXX走到小旗处&#x27;,
            codes: &#x27;go(3)&#x27;,
            mode: &#x27;[[0, 0], [0, 1], [0, 3], [0, 4], [0, 5], [2, 0], [2, 1], [2, 2], [2, 3], [2, 4], [3, 0], [3, 1], [3, 2]]&#x27;,
            author: &#x27;仨瓜俩枣&#x27;
        },
        DELETE_CONFIRM_INFORMATION: &#x27;此操作将永久删除该文件, 是否继续?&#x27;,
        DELETE_FAILURE: &#x27;删除失败&#x27;,
        DELETE_MAP: &#x27;删除地图&#x27;,
        DELETE_SUCCESS: &#x27;删除成功&#x27;,
        DIFFERENT_PASSWORD: &#x27;两次输入密码不一致&#x27;,
        EDIT_MAP: &#x27;制作地图&#x27;,
        EDITOR: &#x27;Editor&#x27;,
        EMAIL: &#x27;邮箱&#x27;,
        FORGET_PASSWORD: &#x27;忘记密码&#x27;,
        GAME_PROGRESS: &#x27;关卡进度&#x27;,
        HOME_PAGE: &#x27;首页&#x27;,
        INTER_GAME: &#x27;点击进入此游戏&#x27;,
        IS_FAVORITE: &#x27;已收藏&#x27;,
        IS_NOT_FAVORITE: &#x27;收藏&#x27;,
        LEVEL_LIMIT: 3,
        LOAD_FAILURE: &#x27;读取失败&#x27;,
        LOAD_SUCCESS: &#x27;读取成功&#x27;,
        LOGIN: &#x27;登录&#x27;,
        LOGIN_FAILURE: &#x27;登录失败&#x27;,
        LOGIN_FIRST: &#x27;请先登录哦!&#x27;,
        LOGIN_SUCCESS: &#x27;登录成功&#x27;,
        MAIN_PAGE_INFORMATION: &#x27;让孩子在游戏中走进编程世界，没有压力，开启头脑风暴&#x27;,
        MAP_AUTHOR: &#x27;作者&#x27;,
        MAP_EDITOR_INFORMATION: &#x27;在这里创建你的地图&#x27;,
        MAP_NAME: &#x27;地图名&#x27;,
        MAP_PUBLISHED: &#x27;已发布&#x27;,
        MAP_REMARKS: &#x27;说明信息&#x27;,
        MAP_SQUARE: &#x27;地图广场&#x27;,
        MAP_UNPUBLISHED: &#x27;未发布&#x27;,
        MY_DISIGNED_MAPS: &#x27;我制作的地图&#x27;,
        MY_FAVORITE_MAPS: &#x27;我收藏的地图&#x27;,
        MY_INFORMATION: &#x27;我的信息&#x27;,
        MY_MAPS: &#x27;我的地图&#x27;,
        MY_PUBLISHED_MAPS: &#x27;我发布的地图&#x27;,
        NEED_CAPTCHA: &#x27;请输入验证码&#x27;,
        NEED_EMAIL: &#x27;请输入邮箱地址&#x27;,
        NEED_EMAIL_CAPTCHA: &#x27;请输入邮件中的验证码&#x27;,
        NEED_LOGIN: &#x27;登录后游玩更多游戏关卡&#x27;,
        NEED_MAP_NAME: &#x27;请输入你的地图名字&#x27;,
        NEED_MAP_REMARKS: &#x27;请输入说明信息&#x27;,
        NEED_NICKNAME: &#x27;请输入昵称&#x27;,
        NEED_PASSWORD: &#x27;请输入密码&#x27;,
        NEED_PASSWORD_REGISTER: &#x27;6-16位数字\\字母\\下划线&#x27;,
        NEED_REPEAT_PASSWORD: &#x27;请再次输入密码&#x27;,
        NICKNAME: &#x27;昵称&#x27;,
        NOT_EXIST_PAGE: &#x27;少年这个网址不存在哦&#x27;,
        OPERATION_FAILURE: &#x27;操作失败&#x27;,
        OPERATION_SUCCESS: &#x27;操作成功&#x27;,
        PASS_LEVEL: &#x27;恭喜您过关!&#x27;,
        PASSWORD: &#x27;密码&#x27;,
        PERSONAL_INFORMATION: &#x27;个人信息&#x27;,
        REGISTER: &#x27;注册&#x27;,
        REGISTER_DATE: &#x27;注册时间&#x27;,
        REGISTER_FAILURE: &#x27;注册失败&#x27;,
        REGISTER_SUCCESS: &#x27;注册成功&#x27;,
        REMAINED_LEVELS: &#x27;剩余的关卡&#x27;,
        REPEAT_PASSWORD: &#x27;确认密码&#x27;,
        RESET: &#x27;重置&#x27;,
        RESET_PASSWORD: &#x27;修改密码&#x27;,
        RUN: &#x27;Run&#x27;,
        SAVE_FAILURE: &#x27;保存失败&#x27;,
        SAVE_SUCCESS: &#x27;保存成功&#x27;,
        SEND_CAPTCHA_EMAIL: &#x27;发送验证码邮件&#x27;,
        SHORT_CAPTCHA: &#x27;验证码长度不足&#x27;,
        SHORT_PASSWORD: &#x27;密码长度不足&#x27;,
        START_GAME: &#x27;开始游戏&#x27;,
        SUBMIT: &#x27;提交&#x27;,
        TEST_PLAY: &#x27;试玩&#x27;,
        TIPS: &#x27;提示&#x27;,
        UNUSED_EMAIL: &#x27;该邮箱尚未注册&#x27;,
        USED_EMAIL: &#x27;该邮箱已被使用&#x27;,
        WRONG_CAPTCHA: &#x27;验证码错误&#x27;,
        WRONG_DISPLAY: &#x27;显示错误&#x27;,
        WRONG_EMAIL_FORMAT: &#x27;邮箱格式错误&#x27;,
        WRONG_PASSWORD_FORMAT: &#x27;密码格式错误&#x27;,
        GAME_INFORMATION: &#x27;&#x27;,
        CHANGE_SUCCESS: &#x27;修改成功&#x27;,
        CHANGE_FALURE: &#x27;修改失败&#x27;
    },
    /**
    *记录登录状态
    *
    * @property loginStatus
    * @type {Boolean}
    * @for state
    * @default false
    */
    loginStatus: false,
    /**
    *记录当前用户的邮箱
    *
    * @property userEmail
    * @type {String}
    * @for state
    * @default null
    */
    userEmail: null,
    /**
    *记录当前用户的ID
    *
    * @property userId
    * @type {Number}
    * @for state
    * @default null
    */
    userId: null,
    /**
    *记录当前用户的昵称
    *
    * @property userNickName
    * @type {String}
    * @for state
    * @default null
    */
    userNickName: null,
    /**
    *记录当前用户的游戏进度
    *
    * @property userGameProgress
    * @type {Number}
    * @for state
    * @default null
    */
    userGameProgress: 1,
    /**
    *记录当前用户支付状态
    *
    * @property userHasPaied
    * @type {Boolean}
    * @for state
    * @default null
    */
    userHasPaied: null,
    /**
    *记录当前用户注册时间
    *
    * @property registerDate
    * @type {String}
    * @for state
    * @default null
    */
    registerDate: null,
    /**
    *记录当前菜单栏选项
    *
    * @property currentMenbar
    * @type {String}
    * @for state
    * @default &#x27;menu-bar-unlogged&#x27;
    */
    currentMenbar: &#x27;menu-bar-unlogged&#x27;,
    /**
    *记录游戏是关卡还是地图状态
    *
    * @property levelMode
    * @type {Boolean}
    * @for state
    * @default true
    */
    levelMode: true,
    /**
    *记录当前地图ID
    *
    * @property mapId
    * @type {Number}
    * @for state
    * @default null
    */
    mapId: null,
    /**
    *登录窗口显示状态
    *
    * @property signinDialog
    * @type {Boolean}
    * @for state
    * @default false
    */
    mapName: &#x27;&#x27;,
    mapTips: &#x27;&#x27;,
    mapCodes: &#x27;&#x27;,
    mapMode: [],
    mapString: &#x27;&#x27;,
    mapAuthor: &#x27;&#x27;,
    signinDialog: false,
    /**
    *记录当前地图字符串
    *
    * @property mapString
    * @type {String}
    * @for state
    * @default &#x27;&#x27;
    */
    /**
    *注册窗口显示状态
    *
    * @property signupDialog
    * @type {Boolean}
    * @for state
    * @default false
    */
    signupDialog: false,
    /**
    *找回密码窗口显示状态
    *
    * @property resetPasswordDialog
    * @type {Boolean}
    * @for state
    * @default false
    */
    resetPasswordDialog: false,
    /**
    *个人信息中更改密码窗口显示状态
    *
    * @property changePasswordDialog
    * @type {Boolean}
    * @for state
    * @default false
    */
    changePasswordDialog: false,
    levelpassModal: false,
    gamereplayModal: false
}

/**
*封装修改vuex全局变量函数的类
*
* @property mutations
* @type {Class}
* @for store
*/
const mutations = {
    /**
    *更改登录状态
    *
    * @method changeLoginStatus
    * @for mutations
    * @param {Object}  state state对象
    * @param {Boolean} status 登录状态
    */
    changeLoginStatus: function (state, status) {
        state.loginStatus = status
    },
    /**
    *更改当前用户的邮箱
    *
    * @method changeUserEmail
    * @for mutations
    * @param {Object}  state state对象
    * @param {String} text 用户邮箱
    */
    changeUserEmail: function (state, text) {
        state.userEmail = text
    },
    /**
    *更改当前用户的ID
    *
    * @method changeUserId
    * @for mutations
    * @param {Object}  state state对象
    * @param {Number} text 用户ID
    */
    changeUserId: function (state, text) {
        state.userId = text
    },
    /**
    *更改当前用户的昵称
    *
    * @method changeUserNickName
    * @for mutations
    * @param {Object}  state state对象
    * @param {String} text 用户昵称
    */
    changeUserNickName: function (state, text) {
        state.userNickName = text
    },
    /**
    *更改当前用户的游戏进度
    *
    * @method changeUserGameProgress
    * @for mutations
    * @param {Object}  state state对象
    * @param {Number} text 当前进度
    */
    changeUserGameProgress: function (state, text) {
        state.userGameProgress = text
    },
    /**
    *更改当前用户的支付状态
    *
    * @method changeUserHasPaied
    * @for mutations
    * @param {Object}  state state对象
    * @param {Boolean} status 当前支付状态
    */
    changeUserHasPaied: function (state, status) {
        state.userHasPaied = status
    },
    /**
    *更改登录窗口显示状态
    *
    * @method signinWindow
    * @for mutations
    * @param {Object}  state state对象
    * @param {Boolean} status 当前登录窗口显示状态
    */
    signinWindow: function (state, status) {
        state.signinDialog = status
    },
    /**
    *更改注册窗口显示状态
    *
    * @method signupWindow
    * @for mutations
    * @param {Object}  state state对象
    * @param {Boolean} status 当前注册窗口显示状态
    */
    signupWindow: function (state, status) {
        state.signupDialog = status
    },
    /**
    *更改找回密码窗口显示状态
    *
    * @method resetPasswordWindow
    * @for mutations
    * @param {Object}  state state对象
    * @param {Boolean} status 当前找回密码窗口显示状态
    */
    resetPasswordWindow: function (state, status) {
        state.resetPasswordDialog = status
    },
    /**
    *更改个人信息界面更改密码窗口显示状态
    *
    * @method changePasswordWindow
    * @for mutations
    * @param {Object}  state state对象
    * @param {Boolean} status 当前个人信息界面更改密码窗口显示状态
    */
    changePasswordWindow: function (state, status) {
        state.changePasswordDialog = status
    },
    /**
    *更改菜单栏
    *
    * @method changeMenu
    * @for mutations
    * @param {Object}  state state对象
    * @param {String} status 当前菜单栏个
    */
    changeMenu: function (state, status) {
        state.currentMenbar = status
    },
    /**
    *更改注册时间
    *
    * @method changeRegisterDate
    * @for mutations
    * @param {Object}  state state对象
    * @param {String} text 注册时间
    */
    changeRegisterDate: function (state, text) {
        var date = new Date(text)
        state.registerDate = date.toLocaleString()
    },
    /**
    *选择游戏处于关卡还是地图编辑器
    *
    * @method changeLevelMode
    * @for mutations
    * @param {Object}  state state对象
    * @param {String} mode mode
    */
    changeLevelMode: function (state, mode) {
        state.levelMode = mode
    },
    changeMap: function (state, obj) {
        let theMap = obj
        if (theMap === null) {
            theMap = state._const.DEFAULT_MAP
            state.levelMode = true
        }
        state.mapId = theMap.id
        state.mapString = theMap.map
        state.mapName = theMap.name
        state.mapTips = theMap.tips
        state.mapCodes = theMap.codes
        state.mapMode = JSON.parse(theMap.mode)
        state.mapAuthor = theMap.author
    },
    changelevelpassModal: function (state, status) {
        state.levelpassModal = status
    },
    changegamereplayModal: function (state, status) {
        state.gamereplayModal = status
    },
    changegameinformation: function (state, text) {
        state._const.GAME_INFORMATION = text
    }
}

/**
*封装vuex全局函数的类
*
* @property actions
* @type {Class}
* @for store
*/
const actions = {
    /**
    *注销登录
    *
    * @method signout
    * @for actions
    * @param {Object}  context
    */
    signout: function (context) {
        context.commit(&#x27;changeLoginStatus&#x27;, false)
        context.commit(&#x27;changeUserEmail&#x27;, null)
        context.commit(&#x27;changeUserId&#x27;, null)
        context.commit(&#x27;changeUserNickName&#x27;, null)
        context.commit(&#x27;changeUserGameProgress&#x27;, null)
        context.commit(&#x27;changeUserHasPaied&#x27;, null)
        context.commit(&#x27;changeMenu&#x27;, &#x27;menu-bar-unlogged&#x27;)
        context.commit(&#x27;changeRegisterDate&#x27;, null)
        context.commit(&#x27;changeMap&#x27;, null)
        fetch(&#x27;api/logout&#x27;, {
            method: &#x27;get&#x27;,
            mode: &#x27;cors&#x27;,
            credentials: &#x27;include&#x27;
        })
    },
    /**
    *界面信息和登录状态等初始化
    *
    * @method init
    * @for actions
    * @param {Object}  context
    */
    init: function (context) {
        context.commit(&#x27;changeLoginStatus&#x27;, false)
        context.commit(&#x27;changeUserEmail&#x27;, null)
        context.commit(&#x27;changeUserId&#x27;, null)
        context.commit(&#x27;changeUserNickName&#x27;, null)
        context.commit(&#x27;changeUserGameProgress&#x27;, 1)
        context.commit(&#x27;changeUserHasPaied&#x27;, null)
        context.commit(&#x27;signinWindow&#x27;, false)
        context.commit(&#x27;signupWindow&#x27;, false)
        context.commit(&#x27;resetPasswordWindow&#x27;, false)
        context.commit(&#x27;changeMenu&#x27;, &#x27;menu-bar-unlogged&#x27;)
        context.commit(&#x27;changeRegisterDate&#x27;, null)
        context.commit(&#x27;changeMap&#x27;, null)
    },
    /**
    *登录
    *
    * @method signin
    * @for actions
    * @param {Object}  context
    */
    signin: async function (context) {
        let response = await fetch(&#x27;api/login&#x27;, {
            method: &#x27;get&#x27;,
            mode: &#x27;cors&#x27;,
            credentials: &#x27;include&#x27;
        })
        let obj = await response.json()
        if (await obj.status === &#x27;1&#x27;) {
            // TODO: 登录成功,传递信息,关闭窗口
            context.commit(&#x27;changeLoginStatus&#x27;, true)
            context.commit(&#x27;changeUserEmail&#x27;, obj.email)
            context.commit(&#x27;changeUserId&#x27;, obj.id)
            context.commit(&#x27;changeUserNickName&#x27;, obj.nickname)
            context.commit(&#x27;changeUserGameProgress&#x27;, obj.gameProgress)
            context.commit(&#x27;changeUserHasPaied&#x27;, obj.hasPaied)
            context.commit(&#x27;changeRegisterDate&#x27;, obj.createdAt)
            context.commit(&#x27;changeMenu&#x27;, &#x27;menu-bar-logged&#x27;)
            context.commit(&#x27;changeMap&#x27;, null)
        } else {}
    }
}

/**
* 由vuex搭建的全局常量, 变量和数据处理函数
*
* @class store
*/
let store = new Vuex.Store({
    state,
    mutations,
    actions
})

export default store

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
